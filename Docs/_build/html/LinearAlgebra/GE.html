
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gaussian Elimination &#8212; Suite 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Basic Linear Algebra" href="Basics.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="gaussian-elimination">
<h1>Gaussian Elimination<a class="headerlink" href="#gaussian-elimination" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we show the class implemented to solve dense linear
systems wrapped from C++ using PyBind11. In particular we will study six
examples, the first three are provided in Lecture 6 of the Numerical
Linear Algebra course at KAUST. The aim of the first three example would
be to show the difference between “naive” Gaussian elimination, Gaussian
elimination with partial pivoting and Gaussian elimination with complete
pivoting. Unfortunately those example where designed for a 3-decimal
floating point arithmetic while the matrix, vector and linear system
classes were implemented in a double precision arithmetic. For this
reason we introduce Example 4 and Example 5, which should show the
advantage respectively of partial and complete pivoting in a double
precision arithmetic. We will use two function of the linear system
class, the first is Gauss(int n) that perform the Gaussian elimination,
where the number n identify the type of pivoting we wont: - n = 0, we do
Naive Gaussian elimination; - n = 1, we do partial Gaussian elimination
searching for non zero pivot; - n = 2, we do partial Gaussian
elimination searching for pivot with greatest magnitude; - n = 3, we do
complete Gaussian elimination. The second is BackSub(), which perform
backward substitution swapping the unknown when needed.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../../Py/Build&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">suite</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span>   <span class="mf">2.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">7.0</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="mf">4.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">3.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">6.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">2.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">3.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">]</span>

<span class="p">(</span><span class="mf">2.000000</span><span class="p">,</span><span class="mf">7.000000</span><span class="p">,</span><span class="mf">4.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">3.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">6.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">0.333333</span><span class="p">,</span><span class="o">-</span><span class="mf">1.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">]</span>

<span class="p">(</span><span class="mf">2.000000</span><span class="p">,</span><span class="mf">5.666667</span><span class="p">,</span><span class="o">-</span><span class="mf">8.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">19.000000</span><span class="p">,</span><span class="o">-</span><span class="mf">7.000000</span><span class="p">,</span><span class="o">-</span><span class="mf">8.000000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2">
<h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span><span class="mf">1.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">0.000100</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">]</span>

<span class="p">(</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">0.000100</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span><span class="o">-</span><span class="mf">9999.000000</span><span class="p">]</span>

<span class="p">(</span><span class="mf">1.000000</span><span class="p">,</span><span class="o">-</span><span class="mf">9999.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">),</span><span class="mf">1.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">);</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">2.000000</span><span class="p">,</span><span class="mf">20000.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">]</span>

<span class="p">(</span><span class="mf">20000.000000</span><span class="p">,</span><span class="mf">2.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">2.000000</span><span class="p">,</span><span class="mf">20000.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span><span class="o">-</span><span class="mf">9999.000000</span><span class="p">]</span>

<span class="p">(</span><span class="mf">20000.000000</span><span class="p">,</span><span class="o">-</span><span class="mf">9998.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1.000100</span><span class="p">,</span><span class="mf">0.999900</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">);</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">20000.000000</span><span class="p">,</span><span class="mf">2.000000</span><span class="p">]</span>
<span class="p">[</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">0.999900</span><span class="p">]</span>

<span class="p">(</span><span class="mf">20000.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1.000100</span><span class="p">,</span><span class="mf">0.999900</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-4">
<h2>Example 4<a class="headerlink" href="#example-4" title="Permalink to this headline">¶</a></h2>
<p>In this example we show the advantage of using partial pivoting compared
with naive Gaussian elimination. We consider the linear system
<span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span>, where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}  A=\begin{pmatrix}
      0 &amp; 1 \\
      1 &amp; 1
  \end{pmatrix}\qquad\qquad \vec{b} = \begin{pmatrix}
  1
  \\
  0
  \end{pmatrix}\end{split}\\we know the solution to the problem is given by the vector:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}  \vec{x} = \begin{pmatrix}
  -1 \\ 1
  \end{pmatrix}\end{split}\\we now perturbate the matrix :math:`A` by a factor :math:`10^{-20}`\end{aligned}\end{align} \]</div>
<p>that is smaller then the machine epsilon, and try to solve the linear
system using “naive” Gaussian elimination.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">),</span><span class="mf">1.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
<p>We clearly find the wrong answer, this is because when subtracting the
first row the second row we yield <span class="math notranslate nohighlight">\(1-10^{20}\)</span>, which can’t be
represented exactly in double precision (IEEE754 has a 15–17 decimals
precision). To avoid this we simply perform Gaussian elimination with
partial pivoting. Since we swap the two rows of the matrix we end up
immediately with an upper triangular matrix.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">),</span><span class="mf">1.0</span><span class="p">,</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-5">
<h2>Example 5<a class="headerlink" href="#example-5" title="Permalink to this headline">¶</a></h2>
<p>Similar problem as the one above occurs when we work with the matrix:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}  A = \begin{pmatrix}
  2 &amp; 2(10^{20})\\
  1 &amp; 1
  \end{pmatrix} \qquad\qquad \vec{b}=\begin{pmatrix}
  2(10^{20})\\
  2
  \end{pmatrix}\end{split}\\the exact result would be:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}  \vec{x} = \begin{pmatrix}
      1+10^{-20} \\
      1-10^{-20}
  \end{pmatrix}\end{split}\\when we perform naive Gaussian elimination and Gaussian elimination the\end{aligned}\end{align} \]</div>
<p>same phenomena as in Example 4 occurs and therefore we obtain the wrong
solution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{x} = \begin{pmatrix}
0\\
1
\end{pmatrix}\end{split}\]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">),</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">);</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">),</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">);</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
<p>Instead with complete pivoting we obtain the solution
<span class="math notranslate nohighlight">\(\vec{x} = (1,1)\)</span> that is the correct solution in floating points
arithmetic since the epsilon machine is around <span class="math notranslate nohighlight">\(10^{-16}\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">A</span><span class="o">.</span><span class="n">from_Array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">),</span>   <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vec</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">20</span><span class="p">);</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">LinSys</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">L</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">L</span><span class="o">.</span><span class="n">BackSub</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.000000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Suite</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Basics.html">Basic Linear Algebra</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Gaussian Elimination</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-1">Example 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-2">Example 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-3">Example 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-4">Example 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-5">Example 5</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Basics.html" title="previous chapter">Basic Linear Algebra</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Umberto Zerbinati.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/LinearAlgebra/GE.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>